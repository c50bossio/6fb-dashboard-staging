INFO:     Will watch for changes in these directories: ['/Users/bossio/6FB AI Agent System']
INFO:     Uvicorn running on http://0.0.0.0:8002 (Press CTRL+C to quit)
INFO:     Started reloader process [28902] using WatchFiles
üöÄ Starting 6FB Enhanced Booking System...
üéØ Barber-First Selection: Active
üß† AI Behavioral Learning: Enabled
üë• Role-Based Access: Admin/Manager/Barber/Customer
üìÖ Google Calendar Integration: Ready
‚è≥ FIFO Waitlist System: Active
üîê Multi-Auth Support: Google/Apple/Facebook/Email
ü§ñ Intelligent Rebooking: AI-Powered
üìä Business Analytics: Real-time
INFO:     Started server process [28946]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:65183 - "GET /api/v1/barbers/1/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:49693 - "GET /api/v1/barbers/2/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:49831 - "GET /api/v1/barbers/3/services HTTP/1.1" 200 OK
INFO:     127.0.0.1:50119 - "GET /api/v1/customers/4/behavior-analysis HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:50409 - "POST /api/v1/auth/register HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:50534 - "POST /api/v1/auth/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:51047 - "GET /api/v1/customers/4/behavior-analysis HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/uvicorn/protocols/http/httptools_impl.py", line 409, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/uvicorn/middleware/proxy_headers.py", line 60, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/applications.py", line 112, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/middleware/errors.py", line 187, in __call__
    raise exc
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/middleware/errors.py", line 165, in __call__
    await self.app(scope, receive, _send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/middleware/exceptions.py", line 62, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/routing.py", line 715, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/routing.py", line 735, in app
    await route.handle(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/routing.py", line 288, in handle
    await self.app(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/routing.py", line 76, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    raise exc
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/_exception_handler.py", line 42, in wrapped_app
    await app(scope, receive, sender)
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/starlette/routing.py", line 73, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/fastapi/routing.py", line 301, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/site-packages/fastapi/routing.py", line 212, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/6FB AI Agent System/enhanced-booking-system.py", line 801, in get_customer_behavior_analysis
    return behavior_analyzer.analyze_customer_behavior(customer_id)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/6FB AI Agent System/ai_behavioral_learning.py", line 82, in analyze_customer_behavior
    self._store_behavior_profile(customer_id, behavior_profile)
  File "/Users/bossio/6FB AI Agent System/ai_behavioral_learning.py", line 587, in _store_behavior_profile
    service_patterns = json.dumps(behavior_profile['service_preferences'])
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/json/__init__.py", line 231, in dumps
    return _default_encoder.encode(obj)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/json/encoder.py", line 200, in encode
    chunks = self.iterencode(o, _one_shot=True)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/json/encoder.py", line 258, in iterencode
    return _iterencode(o, 0)
           ^^^^^^^^^^^^^^^^^
  File "/Users/bossio/.pyenv/versions/3.12.7/lib/python3.12/json/encoder.py", line 180, in default
    raise TypeError(f'Object of type {o.__class__.__name__} '
TypeError: Object of type datetime is not JSON serializable
WARNING:  WatchFiles detected changes in 'ai_behavioral_learning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [28946]
INFO:     Started server process [43962]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'ai_behavioral_learning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [43962]
INFO:     Started server process [44125]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:51469 - "GET /api/v1/customers/4/behavior-analysis HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'ai_behavioral_learning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [44125]
INFO:     Started server process [45527]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:51696 - "GET /api/v1/customers/4/behavior-analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:52295 - "GET /api/v1/customers/4/rebooking-suggestion HTTP/1.1" 200 OK
INFO:     127.0.0.1:52730 - "POST /api/v1/waitlist HTTP/1.1" 200 OK
INFO:     127.0.0.1:55323 - "POST /api/v1/auth/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:55577 - "GET /api/v1/auth/me HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:55579 - "POST /api/v1/waitlist HTTP/1.1" 200 OK
INFO:     127.0.0.1:55925 - "GET /api/v1/analytics/waitlist?location_id=1 HTTP/1.1" 200 OK
INFO:     127.0.0.1:56125 - "GET /api/v1/customers/7/waitlist HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'role_based_calendar_manager.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [45527]
INFO:     Started server process [61462]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [61462]
INFO:     Started server process [61627]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [61627]
INFO:     Started server process [62111]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:57434 - "GET /api/v1/health HTTP/1.1" 200 OK
INFO:     127.0.0.1:58582 - "GET /api/v1/calendar/access HTTP/1.1" 200 OK
INFO:     127.0.0.1:59548 - "GET /api/v1/calendar/access HTTP/1.1" 200 OK
INFO:     127.0.0.1:60667 - "GET /api/v1/calendar/barbers/1/availability?date=2025-08-01&service_duration=30 HTTP/1.1" 200 OK
INFO:     127.0.0.1:62280 - "GET /api/v1/calendar/barbers/1/availability?date=2025-08-01&service_duration=30 HTTP/1.1" 500 Internal Server Error
WARNING:  WatchFiles detected changes in 'multi_auth_system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [62111]
INFO:     Started server process [73310]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [73310]
INFO:     Started server process [73443]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [73443]
INFO:     Started server process [73802]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:64456 - "GET /api/v1/health HTTP/1.1" 200 OK
INFO:     127.0.0.1:64628 - "POST /api/v1/auth/email/register HTTP/1.1" 422 Unprocessable Entity
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [73802]
INFO:     Started server process [76414]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [76414]
INFO:     Started server process [76475]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [76475]
INFO:     Started server process [76608]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [76608]
INFO:     Started server process [76655]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:64975 - "POST /api/v1/auth/email/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:65284 - "POST /api/v1/auth/email/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:49619 - "GET /api/v1/auth/google/authorize HTTP/1.1" 200 OK
INFO:     127.0.0.1:49621 - "GET /api/v1/auth/facebook/authorize HTTP/1.1" 200 OK
INFO:     127.0.0.1:49623 - "GET /api/v1/auth/apple/authorize HTTP/1.1" 200 OK
INFO:     127.0.0.1:49883 - "GET /api/v1/auth/methods HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:49888 - "POST /api/v1/auth/refresh HTTP/1.1" 422 Unprocessable Entity
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [76655]
INFO:     Started server process [79016]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79016]
INFO:     Started server process [79138]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:50936 - "POST /api/v1/auth/email/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:50945 - "POST /api/v1/auth/refresh HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'ai_behavioral_learning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [79138]
INFO:     Started server process [81648]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
WARNING:  WatchFiles detected changes in 'ai_behavioral_learning.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [81648]
INFO:     Started server process [81777]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:51729 - "GET /api/v1/customers/4/behavior-analysis HTTP/1.1" 403 Forbidden
INFO:     127.0.0.1:51765 - "POST /api/v1/auth/email/login HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:51798 - "POST /api/v1/auth/email/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:51844 - "GET /api/v1/customers/11/behavior-analysis HTTP/1.1" 401 Unauthorized
INFO:     127.0.0.1:51955 - "GET /api/v1/health HTTP/1.1" 200 OK
WARNING:  WatchFiles detected changes in 'enhanced-booking-system.py'. Reloading...
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [81777]
INFO:     Started server process [83042]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     127.0.0.1:52292 - "GET /api/v1/customers/11/behavior-analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:52371 - "GET /api/v1/customers/11/rebooking-suggestion HTTP/1.1" 200 OK
INFO:     127.0.0.1:52426 - "GET /api/v1/auth/google/authorize HTTP/1.1" 200 OK
INFO:     127.0.0.1:52474 - "POST /api/v1/auth/refresh HTTP/1.1" 200 OK
INFO:     127.0.0.1:54495 - "POST /api/v1/auth/email/register HTTP/1.1" 200 OK
INFO:     127.0.0.1:54706 - "POST /api/v1/auth/email/login HTTP/1.1" 200 OK
INFO:     127.0.0.1:54772 - "GET /api/v1/auth/apple/authorize HTTP/1.1" 200 OK
INFO:     127.0.0.1:54774 - "GET /api/v1/auth/facebook/authorize HTTP/1.1" 200 OK
INFO:     127.0.0.1:54889 - "GET /api/v1/customers/12/behavior-analysis HTTP/1.1" 200 OK
INFO:     127.0.0.1:55656 - "GET /api/v1/customers/12/rebooking-suggestion HTTP/1.1" 200 OK
INFO:     127.0.0.1:55750 - "GET /api/v1/calendar/access HTTP/1.1" 200 OK
INFO:     127.0.0.1:56015 - "GET /api/v1/calendar/access HTTP/1.1" 200 OK
INFO:     127.0.0.1:56105 - "GET /api/v1/calendar/barbers/1/availability?date=2025-08-01&service_duration=30 HTTP/1.1" 500 Internal Server Error
INFO:     127.0.0.1:56215 - "POST /api/v1/waitlist HTTP/1.1" 422 Unprocessable Entity
INFO:     127.0.0.1:56332 - "POST /api/v1/waitlist HTTP/1.1" 200 OK
INFO:     127.0.0.1:56389 - "GET /api/v1/customers/12/waitlist HTTP/1.1" 200 OK
INFO:     127.0.0.1:56507 - "GET /api/v1/health HTTP/1.1" 200 OK
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [83042]
INFO:     Stopping reloader process [28902]
