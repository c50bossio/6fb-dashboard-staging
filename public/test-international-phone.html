<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>International Phone Input Test - Twilio Ready</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .phone-container {
            max-width: 600px;
            margin: 2rem auto;
            padding: 2rem;
            background: white;
            border-radius: 0.5rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="phone-container">
        <h1 class="text-2xl font-bold text-gray-900 mb-6">ğŸŒ International Phone Input Test</h1>
        <p class="text-gray-600 mb-8">Test the international phone input with country code support for Twilio SMS integration.</p>
        
        <div class="space-y-6">
            <!-- Test Form -->
            <div>
                <label class="block text-sm font-medium text-gray-700 mb-2">
                    Phone Number (with Country Code)
                </label>
                <div id="phone-input-container"></div>
            </div>
            
            <!-- Results Display -->
            <div class="bg-gray-50 p-4 rounded-md">
                <h3 class="text-lg font-medium text-gray-900 mb-3">Test Results:</h3>
                <div id="results" class="space-y-2 text-sm font-mono">
                    <div>Formatted Display: <span id="display-value" class="text-blue-600">-</span></div>
                    <div>E.164 for Twilio: <span id="e164-value" class="text-green-600">-</span></div>
                    <div>Country Code: <span id="country-value" class="text-purple-600">-</span></div>
                    <div>Dial Code: <span id="dial-code-value" class="text-orange-600">-</span></div>
                    <div>Valid: <span id="valid-value" class="text-red-600">-</span></div>
                </div>
            </div>
            
            <!-- Test Cases -->
            <div class="bg-blue-50 p-4 rounded-md">
                <h3 class="text-lg font-medium text-blue-900 mb-3">ğŸ§ª Test Cases to Try:</h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4 text-sm">
                    <div>
                        <h4 class="font-semibold text-blue-800">US/Canada Numbers:</h4>
                        <ul class="list-disc list-inside text-blue-700 space-y-1">
                            <li>5551234567</li>
                            <li>+1 555 123 4567</li>
                            <li>15551234567</li>
                        </ul>
                    </div>
                    <div>
                        <h4 class="font-semibold text-blue-800">International Numbers:</h4>
                        <ul class="list-disc list-inside text-blue-700 space-y-1">
                            <li>+44 20 7946 0958 (UK)</li>
                            <li>+49 30 12345678 (Germany)</li>
                            <li>+33 1 23 45 67 89 (France)</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Twilio Integration Info -->
            <div class="bg-green-50 p-4 rounded-md">
                <h3 class="text-lg font-medium text-green-900 mb-3">ğŸ“± Twilio SMS Integration</h3>
                <p class="text-green-800 text-sm">
                    This component automatically generates E.164 format phone numbers required by Twilio for international SMS delivery. 
                    The E.164 format (e.g., +15551234567) ensures reliable message delivery worldwide.
                </p>
            </div>
        </div>
    </div>

    <!-- Manual Implementation for Testing -->
    <script>
        // Country codes data (simplified for testing)
        const COUNTRY_CODES = [
            { code: 'US', name: 'United States', dialCode: '+1', flag: 'ğŸ‡ºğŸ‡¸' },
            { code: 'CA', name: 'Canada', dialCode: '+1', flag: 'ğŸ‡¨ğŸ‡¦' },
            { code: 'GB', name: 'United Kingdom', dialCode: '+44', flag: 'ğŸ‡¬ğŸ‡§' },
            { code: 'DE', name: 'Germany', dialCode: '+49', flag: 'ğŸ‡©ğŸ‡ª' },
            { code: 'FR', name: 'France', dialCode: '+33', flag: 'ğŸ‡«ğŸ‡·' },
            { code: 'AU', name: 'Australia', dialCode: '+61', flag: 'ğŸ‡¦ğŸ‡º' },
            { code: 'MX', name: 'Mexico', dialCode: '+52', flag: 'ğŸ‡²ğŸ‡½' },
        ];

        let selectedCountry = 'US';
        let isDropdownOpen = false;

        // Format phone number based on country
        function formatByCountry(value, countryCode) {
            if (!value) return value;
            
            const digits = value.replace(/[^\d]/g, '');
            
            switch (countryCode) {
                case 'US':
                case 'CA':
                    if (digits.length <= 3) return `(${digits}`;
                    if (digits.length <= 6) return `(${digits.slice(0, 3)}) ${digits.slice(3)}`;
                    return `(${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6, 10)}`;
                
                case 'GB':
                    if (digits.length <= 4) return digits;
                    if (digits.length <= 7) return `${digits.slice(0, 4)} ${digits.slice(4)}`;
                    return `${digits.slice(0, 4)} ${digits.slice(4, 7)} ${digits.slice(7, 11)}`;
                
                case 'DE':
                    if (digits.length <= 3) return digits;
                    return `${digits.slice(0, 3)} ${digits.slice(3)}`;
                
                case 'FR':
                    if (digits.length <= 2) return digits;
                    if (digits.length <= 4) return `${digits.slice(0, 2)} ${digits.slice(2)}`;
                    if (digits.length <= 6) return `${digits.slice(0, 2)} ${digits.slice(2, 4)} ${digits.slice(4)}`;
                    if (digits.length <= 8) return `${digits.slice(0, 2)} ${digits.slice(2, 4)} ${digits.slice(4, 6)} ${digits.slice(6)}`;
                    return `${digits.slice(0, 2)} ${digits.slice(2, 4)} ${digits.slice(4, 6)} ${digits.slice(6, 8)} ${digits.slice(8, 10)}`;
                
                default:
                    const groups = digits.match(/.{1,3}/g) || [];
                    return groups.join(' ');
            }
        }

        // Generate E.164 format
        function toE164Format(phoneNumber, countryDialCode) {
            if (!phoneNumber) return '';
            const digits = phoneNumber.replace(/[^\d]/g, '');
            if (!digits) return '';
            return `${countryDialCode}${digits}`;
        }

        // Update results display
        function updateResults(phoneNumber) {
            const country = COUNTRY_CODES.find(c => c.code === selectedCountry);
            const formatted = formatByCountry(phoneNumber, selectedCountry);
            const e164 = toE164Format(phoneNumber, country.dialCode);
            const digits = phoneNumber.replace(/[^\d]/g, '');
            
            document.getElementById('display-value').textContent = formatted || '-';
            document.getElementById('e164-value').textContent = e164 || '-';
            document.getElementById('country-value').textContent = country.name;
            document.getElementById('dial-code-value').textContent = country.dialCode;
            
            // Simple validation
            const isValid = digits.length >= 7 && digits.length <= 15;
            document.getElementById('valid-value').textContent = isValid ? 'âœ… Valid' : 'âŒ Invalid';
            document.getElementById('valid-value').className = isValid ? 'text-green-600' : 'text-red-600';
        }

        // Create the phone input interface
        function createPhoneInput() {
            const container = document.getElementById('phone-input-container');
            const selectedCountryData = COUNTRY_CODES.find(c => c.code === selectedCountry);
            
            container.innerHTML = `
                <div class="flex">
                    <!-- Country Dropdown -->
                    <div class="relative">
                        <button type="button" id="country-button" class="flex items-center px-3 py-2 border border-r-0 rounded-l-md bg-gray-50 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-blue-500 cursor-pointer">
                            <span class="text-lg mr-1">${selectedCountryData.flag}</span>
                            <span class="text-sm font-medium text-gray-700">${selectedCountryData.dialCode}</span>
                            <svg class="ml-1 h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
                            </svg>
                        </button>
                        
                        <!-- Dropdown Menu -->
                        <div id="dropdown-menu" class="absolute z-50 top-full left-0 w-80 bg-white border border-gray-200 rounded-md shadow-lg max-h-60 overflow-y-auto hidden">
                            ${COUNTRY_CODES.map(country => `
                                <button type="button" onclick="selectCountry('${country.code}')" class="w-full px-3 py-2 text-left hover:bg-blue-50 flex items-center ${selectedCountry === country.code ? 'bg-blue-100' : ''}">
                                    <span class="text-lg mr-2">${country.flag}</span>
                                    <div class="flex-1">
                                        <div class="text-sm font-medium text-gray-900">${country.name}</div>
                                        <div class="text-xs text-gray-500">${country.dialCode}</div>
                                    </div>
                                </button>
                            `).join('')}
                        </div>
                    </div>
                    
                    <!-- Phone Input -->
                    <input 
                        type="tel" 
                        id="phone-input"
                        placeholder="Enter phone number"
                        class="flex-1 px-3 py-2 border border-gray-300 rounded-r-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                    />
                </div>
            `;

            // Add event listeners
            document.getElementById('country-button').addEventListener('click', toggleDropdown);
            document.getElementById('phone-input').addEventListener('input', handlePhoneInput);
            
            // Close dropdown when clicking outside
            document.addEventListener('click', function(event) {
                const dropdown = document.getElementById('dropdown-menu');
                const button = document.getElementById('country-button');
                if (!dropdown.contains(event.target) && !button.contains(event.target)) {
                    dropdown.classList.add('hidden');
                    isDropdownOpen = false;
                }
            });
        }

        function toggleDropdown() {
            const dropdown = document.getElementById('dropdown-menu');
            if (isDropdownOpen) {
                dropdown.classList.add('hidden');
            } else {
                dropdown.classList.remove('hidden');
            }
            isDropdownOpen = !isDropdownOpen;
        }

        function selectCountry(countryCode) {
            selectedCountry = countryCode;
            isDropdownOpen = false;
            createPhoneInput();
            
            // Re-format current phone number for new country
            const phoneInput = document.getElementById('phone-input');
            if (phoneInput.value) {
                const formatted = formatByCountry(phoneInput.value, selectedCountry);
                phoneInput.value = formatted;
                updateResults(phoneInput.value);
            }
        }

        function handlePhoneInput(event) {
            const value = event.target.value;
            const formatted = formatByCountry(value, selectedCountry);
            event.target.value = formatted;
            updateResults(formatted);
        }

        // Initialize
        createPhoneInput();
        updateResults('');
        
        // Add some demo data
        setTimeout(() => {
            document.getElementById('phone-input').value = '5551234567';
            handlePhoneInput({ target: document.getElementById('phone-input') });
        }, 1000);
    </script>
</body>
</html>