<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Auto-Formatting Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f9fafb;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }
        .input-field {
            width: 100%;
            padding: 8px 12px;
            border: 1px solid #d1d5db;
            border-radius: 6px;
            font-size: 14px;
            margin: 8px 0;
        }
        .input-field:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }
        .border-red-500 {
            border-color: #ef4444 !important;
        }
        .nuclear-input-container {
            margin: 10px 0;
        }
        .text-red-500 {
            color: #ef4444;
        }
        .text-green-500 {
            color: #10b981;
        }
        .text-sm {
            font-size: 14px;
        }
        .mt-1 {
            margin-top: 4px;
        }
        .flex {
            display: flex;
        }
        .items-center {
            align-items: center;
        }
        .mr-1 {
            margin-right: 4px;
        }
        h1 {
            color: #1f2937;
            text-align: center;
        }
        h2 {
            color: #374151;
            border-bottom: 2px solid #e5e7eb;
            padding-bottom: 10px;
        }
        .test-instructions {
            background-color: #eff6ff;
            border-left: 4px solid #3b82f6;
            padding: 16px;
            margin: 16px 0;
        }
        .test-case {
            margin: 16px 0;
            padding: 12px;
            background-color: #f8fafc;
            border-radius: 6px;
        }
        .test-case h4 {
            margin: 0 0 8px 0;
            color: #1e40af;
        }
        .result-display {
            background-color: #f3f4f6;
            padding: 8px;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            color: #374151;
            margin-top: 8px;
        }
    </style>
</head>
<body>
    <h1>ðŸ§ª Auto-Formatting Test Suite</h1>
    
    <div class="test-instructions">
        <h3>Testing Instructions:</h3>
        <ol>
            <li>Type various formats into each input field</li>
            <li>Watch for real-time formatting as you type</li>
            <li>Tab out to see validation feedback</li>
            <li>Test edge cases and invalid inputs</li>
        </ol>
    </div>

    <div class="test-section">
        <h2>ðŸ“ž Phone Number Formatting</h2>
        
        <div class="test-case">
            <h4>Test Case 1: US Phone Number</h4>
            <p>Try typing: 5551234567, 15551234567, +15551234567</p>
            <div id="phone-test-1"></div>
            <div class="result-display" id="phone-result-1">Result will appear here...</div>
        </div>

        <div class="test-case">
            <h4>Test Case 2: International Phone</h4>
            <p>Try typing: +44 20 7946 0958, +33 1 42 86 83 26</p>
            <div id="phone-test-2"></div>
            <div class="result-display" id="phone-result-2">Result will appear here...</div>
        </div>

        <div class="test-case">
            <h4>Test Case 3: Partial Numbers</h4>
            <p>Try typing partial numbers like: 555, 5551, 555123</p>
            <div id="phone-test-3"></div>
            <div class="result-display" id="phone-result-3">Result will appear here...</div>
        </div>
    </div>

    <div class="test-section">
        <h2>ðŸ“§ Email Formatting</h2>
        
        <div class="test-case">
            <h4>Test Case 1: Mixed Case Email</h4>
            <p>Try typing: TEST@EXAMPLE.COM, Test.User@Gmail.Com</p>
            <div id="email-test-1"></div>
            <div class="result-display" id="email-result-1">Result will appear here...</div>
        </div>

        <div class="test-case">
            <h4>Test Case 2: Invalid Email</h4>
            <p>Try typing: invalid@@email.com, test@, @example.com</p>
            <div id="email-test-2"></div>
            <div class="result-display" id="email-result-2">Result will appear here...</div>
        </div>
    </div>

    <div class="test-section">
        <h2>ðŸ’° Currency Formatting</h2>
        
        <div class="test-case">
            <h4>Test Case 1: Currency Input</h4>
            <p>Try typing: 123.45, 1000, 50.678</p>
            <div id="currency-test-1"></div>
            <div class="result-display" id="currency-result-1">Result will appear here...</div>
        </div>
    </div>

    <div class="test-section">
        <h2>ðŸ“® ZIP Code Formatting</h2>
        
        <div class="test-case">
            <h4>Test Case 1: ZIP Code Input</h4>
            <p>Try typing: 12345, 123456789, 90210</p>
            <div id="zip-test-1"></div>
            <div class="result-display" id="zip-result-1">Result will appear here...</div>
        </div>
    </div>

    <!-- Import the formatters -->
    <script type="module">
        // Import formatters (simulated here since we can't use ES6 modules directly)
        
        // Phone Number Formatter
        function formatPhoneNumber(value) {
            if (!value) return value
            
            const phoneNumber = value.replace(/[^\d]/g, '')
            const phoneNumberLength = phoneNumber.length
            
            if (phoneNumberLength < 4) return phoneNumber
            
            if (phoneNumberLength < 7) {
                return `(${phoneNumber.slice(0, 3)}) ${phoneNumber.slice(3)}`
            }
            
            if (phoneNumberLength <= 10) {
                return `(${phoneNumber.slice(0, 3)}) ${phoneNumber.slice(3, 6)}-${phoneNumber.slice(6, 10)}`
            }
            
            if (phoneNumberLength === 11 && phoneNumber.startsWith('1')) {
                return `+1 (${phoneNumber.slice(1, 4)}) ${phoneNumber.slice(4, 7)}-${phoneNumber.slice(7, 11)}`
            }
            
            return `(${phoneNumber.slice(0, 3)}) ${phoneNumber.slice(3, 6)}-${phoneNumber.slice(6, 10)}`
        }

        // International Phone Formatter  
        function formatInternationalPhone(value) {
            if (!value) return value
            
            let cleaned = value.replace(/[^\d+]/g, '')
            
            if (cleaned.startsWith('+1')) {
                const digits = cleaned.slice(2)
                if (digits.length >= 10) {
                    return `+1 (${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6, 10)}`
                } else if (digits.length >= 6) {
                    return `+1 (${digits.slice(0, 3)}) ${digits.slice(3, 6)}-${digits.slice(6)}`
                } else if (digits.length >= 3) {
                    return `+1 (${digits.slice(0, 3)}) ${digits.slice(3)}`
                } else {
                    return `+1 ${digits}`
                }
            }
            
            if (cleaned.startsWith('+')) {
                const countryCode = cleaned.slice(0, cleaned.length >= 3 ? 3 : cleaned.length)
                const remainder = cleaned.slice(countryCode.length)
                
                if (remainder.length > 6) {
                    return `${countryCode} ${remainder.slice(0, 3)} ${remainder.slice(3, 6)} ${remainder.slice(6)}`
                } else if (remainder.length > 3) {
                    return `${countryCode} ${remainder.slice(0, 3)} ${remainder.slice(3)}`
                } else {
                    return `${countryCode} ${remainder}`
                }
            }
            
            return cleaned
        }

        // Email Formatter
        function formatEmail(value) {
            if (!value) return value
            
            let formatted = value.toLowerCase().trim()
            
            const atIndex = formatted.indexOf('@')
            if (atIndex !== -1) {
                const beforeAt = formatted.slice(0, atIndex)
                const afterAt = formatted.slice(atIndex + 1).replace(/@/g, '')
                formatted = beforeAt + '@' + afterAt
            }
            
            return formatted
        }

        // Currency Formatter
        function formatCurrency(value) {
            if (!value) return value
            
            const numericValue = value.replace(/[^\d.]/g, '')
            
            const parts = numericValue.split('.')
            if (parts.length > 2) {
                const formatted = parts[0] + '.' + parts.slice(1).join('')
                return '$' + formatted
            }
            
            if (parts[1] && parts[1].length > 2) {
                parts[1] = parts[1].slice(0, 2)
            }
            
            const result = parts.join('.')
            return result ? '$' + result : ''
        }

        // ZIP Code Formatter
        function formatZipCode(value) {
            if (!value) return value
            
            const cleaned = value.replace(/[^\d]/g, '')
            
            if (cleaned.length <= 5) {
                return cleaned
            } else if (cleaned.length <= 9) {
                return `${cleaned.slice(0, 5)}-${cleaned.slice(5)}`
            }
            
            return cleaned.slice(0, 9)
        }

        // Validation helpers
        function validatePhone(value) {
            const digits = value.replace(/[^\d]/g, '')
            return digits.length >= 10
        }

        function validateEmail(value) {
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/
            return emailRegex.test(value)
        }

        // Create Nuclear Input equivalent
        function createNuclearInput(config) {
            const container = document.createElement('div')
            container.className = 'nuclear-input-container'
            
            const input = document.createElement('input')
            input.type = config.type || 'text'
            input.placeholder = config.placeholder || ''
            input.className = 'input-field'
            
            let validationDiv = null
            
            input.addEventListener('input', function(e) {
                const currentValue = e.target.value
                let formattedValue = currentValue
                
                // Apply appropriate formatter
                if (config.formatter) {
                    formattedValue = config.formatter(currentValue)
                }
                
                if (formattedValue !== currentValue) {
                    const cursorPosition = e.target.selectionStart
                    const lengthDiff = formattedValue.length - currentValue.length
                    
                    e.target.value = formattedValue
                    
                    const newCursorPosition = Math.max(0, cursorPosition + lengthDiff)
                    e.target.setSelectionRange(newCursorPosition, newCursorPosition)
                }
                
                // Update result display
                if (config.resultId) {
                    document.getElementById(config.resultId).textContent = 
                        `Formatted: "${formattedValue}" | Length: ${formattedValue.length}`
                }
            })
            
            input.addEventListener('blur', function(e) {
                const value = e.target.value
                
                // Validation
                if (config.validator && value) {
                    const isValid = config.validator(value)
                    
                    if (validationDiv) {
                        validationDiv.remove()
                    }
                    
                    validationDiv = document.createElement('div')
                    validationDiv.className = `text-sm mt-1 flex items-center ${isValid ? 'text-green-500' : 'text-red-500'}`
                    
                    const icon = document.createElement('span')
                    icon.className = 'mr-1'
                    icon.textContent = isValid ? 'âœ“' : 'âš '
                    
                    const message = document.createElement('span')
                    message.textContent = isValid ? 'Valid format' : 'Invalid format'
                    
                    validationDiv.appendChild(icon)
                    validationDiv.appendChild(message)
                    container.appendChild(validationDiv)
                    
                    // Update input border
                    input.className = `input-field ${!isValid ? 'border-red-500' : ''}`
                }
            })
            
            container.appendChild(input)
            return container
        }

        // Create test inputs
        const testConfigs = [
            // Phone tests
            { 
                containerId: 'phone-test-1', 
                type: 'tel', 
                placeholder: '(555) 123-4567',
                formatter: formatPhoneNumber,
                validator: validatePhone,
                resultId: 'phone-result-1'
            },
            { 
                containerId: 'phone-test-2', 
                type: 'tel', 
                placeholder: '+1 (555) 123-4567',
                formatter: formatInternationalPhone,
                validator: validatePhone,
                resultId: 'phone-result-2'
            },
            { 
                containerId: 'phone-test-3', 
                type: 'tel', 
                placeholder: 'Partial number test',
                formatter: formatPhoneNumber,
                validator: validatePhone,
                resultId: 'phone-result-3'
            },
            
            // Email tests
            { 
                containerId: 'email-test-1', 
                type: 'email', 
                placeholder: 'your@email.com',
                formatter: formatEmail,
                validator: validateEmail,
                resultId: 'email-result-1'
            },
            { 
                containerId: 'email-test-2', 
                type: 'email', 
                placeholder: 'test invalid emails',
                formatter: formatEmail,
                validator: validateEmail,
                resultId: 'email-result-2'
            },
            
            // Currency test
            { 
                containerId: 'currency-test-1', 
                type: 'text', 
                placeholder: '$0.00',
                formatter: formatCurrency,
                resultId: 'currency-result-1'
            },
            
            // ZIP test
            { 
                containerId: 'zip-test-1', 
                type: 'text', 
                placeholder: '12345 or 12345-6789',
                formatter: formatZipCode,
                resultId: 'zip-result-1'
            }
        ]

        // Initialize all test inputs
        testConfigs.forEach(config => {
            const container = document.getElementById(config.containerId)
            const input = createNuclearInput(config)
            container.appendChild(input)
        })

        console.log('Auto-formatting test suite initialized!')
    </script>
</body>
</html>